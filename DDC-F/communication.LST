C51 COMPILER V9.51   COMMUNICATION                                                         11/14/2013 10:54:22 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE COMMUNICATION
OBJECT MODULE PLACED IN communication.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\C51.EXE communication.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND 
                    -TABS(3)

line level    source

   1          /*---------------------------------------------------
   2             communication.c (v1.00)
   3             
   4             通信程序
   5          ---------------------------------------------------*/ 
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "communication.h"
  11          #include "Delay.h"
  12          
  13          tByte myTxRxData[7]={0x00,0x00,0x00,0x00,0x00,0x00,0x00};
  14          
  15          /*--------------------------------------------------
  16             ComMode_1_Data()
  17             
  18             发送编码1到主机，主机会返回一个编码1信号，如果附机
  19             收到了，则附机知道主机在附近了。
  20          ---------------------------------------------------*/
  21          void ComMode_1_Data()         
  22             {
  23   1         tByte i,n;
  24   1      
  25   1         Transmitter_EN = 1;     //打开无线发射机
  26   1         myTxRxData[0]=CmdHead;
  27   1         myTxRxData[1]=MyAddress;
  28   1         myTxRxData[2]=ComMode_1;
  29   1      
  30   1         initsignal();
  31   1      
  32   1         for(i=0;i<3;i++)
  33   1            {
  34   2            for(n=0;n<8;n++)
  35   2               {
  36   3               if((myTxRxData[i]&0x80)==0x80)
  37   3                  {
  38   4                  transmit_wire=0;
  39   4                  Delay3(120);   
  40   4                  }
  41   3               else  
  42   3                  {
  43   4                  transmit_wire=0;
  44   4                  Delay3(80);
  45   4                  }
  46   3               transmit_wire=1;
  47   3               myTxRxData[i]<<=1;
  48   3               Delay3(50);
  49   3               }
  50   2            }
  51   1         Transmitter_EN = 0;     //关闭发射机
  52   1         }
  53          
  54          /*----------------------------------------------------
C51 COMPILER V9.51   COMMUNICATION                                                         11/14/2013 10:54:22 PAGE 2   

  55             initsignal()
  56             
  57             初始化信号程序，接收机在接接收信号的时候，需要有
  58             一段代码来使接收机打开，而这一段程序有可能无法识别
  59             出来，而是相当于废代码，只占用通信时间。
  60          ----------------------------------------------------*/
  61          
  62          void initsignal()          
  63             {
  64   1         tByte k,k1;
  65   1         tByte mystartbuffer=0xaa;
  66   1         for(k1=0;k1<1;k1++)
  67   1            {
  68   2            for(k=0;k<8;k++)
  69   2               {
  70   3               if((mystartbuffer&0x80)==0x80)
  71   3                  {
  72   4                  transmit_wire=0;
  73   4                  Delay3(80); 
  74   4                  }
  75   3               else
  76   3                  {
  77   4                  transmit_wire=0;
  78   4                  Delay3(80); 
  79   4                  }
  80   3               transmit_wire=1;
  81   3               mystartbuffer<<=1;
  82   3               Delay3(150);   
  83   3               }
  84   2            mystartbuffer=0xaa;
  85   2            Delay3(80);
  86   2            }
  87   1         transmit_wire=1;
  88   1         }
  89          
  90          /*---------------------------------------------------
  91             end of file
  92          ----------------------------------------------------*/
  93          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    153    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
