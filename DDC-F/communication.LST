C51 COMPILER V9.51   COMMUNICATION                                                         09/27/2013 10:58:46 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE COMMUNICATION
OBJECT MODULE PLACED IN communication.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\C51.EXE communication.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*---------------------------------------------------
   2                  communication.c (v1.00)
   3                  
   4                  通信程序
   5          ---------------------------------------------------*/   
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "communication.h"
  11          #include "Delay.h"
  12          
  13          tByte myTxRxData[7]={0x00,0x00,0x00,0x00,0x00,0x00,0x00};
  14          
  15          /*--------------------------------------------------
  16                  ComMode_1_Data()
  17                  
  18                  发送编码1到主机，主机会返回一个编码1信号，如果附机
  19                  收到了，则附机知道主机在附近了。
  20          ---------------------------------------------------*/
  21          void ComMode_1_Data()                   
  22                  {
  23   1              tByte i,n;
  24   1      
  25   1              ModeControl_1=0;        //30M发射功率                           
  26   1              tran_en=1;      //打开无线发射机
  27   1              myTxRxData[0]=CmdHead;
  28   1              myTxRxData[1]=MyAddress;
  29   1              myTxRxData[2]=ComMode_1;
  30   1      
  31   1              initsignal();
  32   1      
  33   1              for(i=0;i<3;i++)
  34   1                      {
  35   2                      for(n=0;n<8;n++)
  36   2                              {
  37   3                              if((myTxRxData[i]&0x80)==0x80)
  38   3                                      {
  39   4                                      P10=0;
  40   4                                      Delay3(120);    
  41   4                                      }
  42   3                              else    
  43   3                                      {
  44   4                                      P10=0;
  45   4                                      Delay3(80);
  46   4                                      }
  47   3                              P10=1;
  48   3                              myTxRxData[i]<<=1;
  49   3                              Delay3(50);
  50   3                              }
  51   2                      }
  52   1              tran_en=0;
  53   1              }
  54          
  55          /*----------------------------------------------------
C51 COMPILER V9.51   COMMUNICATION                                                         09/27/2013 10:58:46 PAGE 2   

  56                  initsignal()
  57                  
  58                  初始化信号程序，接收机在接接收信号的时候，需要有
  59                  一段代码来使接收机打开，而这一段程序有可能无法识别
  60                  出来，而是相当于废代码，只占用通信时间。
  61          ----------------------------------------------------*/
  62          
  63          void initsignal()                               
  64                  {
  65   1              tByte k,k1;
  66   1              tByte mystartbuffer=0xaa;
  67   1              for(k1=0;k1<1;k1++)
  68   1                      {
  69   2                      for(k=0;k<8;k++)
  70   2                              {
  71   3                              if((mystartbuffer&0x80)==0x80)
  72   3                                      {
  73   4                                      P10=0;
  74   4                                      Delay3(80);     
  75   4                                      }
  76   3                              else
  77   3                                      {
  78   4                                      P10=0;
  79   4                                      Delay3(80);     
  80   4                                      }
  81   3                              P10=1;
  82   3                              mystartbuffer<<=1;
  83   3                              Delay3(150);    
  84   3                              }
  85   2                      mystartbuffer=0xaa;
  86   2                      Delay3(80);
  87   2                      }
  88   1              P10=1;
  89   1              }
  90          
  91          /*---------------------------------------------------
  92                  end of file
  93          ----------------------------------------------------*/
  94          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    155    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      7       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
