C51 COMPILER V9.51   MAIN                                                                  11/14/2013 10:54:22 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\C51.EXE main.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND TABS(3)

line level    source

   1          /*---------------------------------------------------
   2             main.c (v1.00)
   3             
   4             DDC-F program, for electrocar.
   5          ----------------------------------------------------*/
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "AD.h"
  11          #include "Timer.h"
  12          #include "voice.h"
  13          #include "pwm.h"
  14          #include "Delay.h"
  15          #include "communication.h"
  16          #include "Other.h"
  17          
  18          /*------- Public variable declarations --------------------------*/
  19          extern bit fell_alarm_flag;            //µ¹µØ±¨¾¯±êÖ¾
  20          extern bit raised_alarm_flag;          //Ì§Æð±¨¾¯±êÖ¾
  21          extern bit stolen_alarm_flag;          //±»µÁ±¨¾¯±êÖ¾
  22          extern tWord stolen_alarm_count;       //±»µÁ±¨¾¯Ñ­»·´ÎÊý
  23          extern bit comm_whole_control;         //Í¨ÐÅ×Ü¿ª¹Ø£¬0¹Ø±ÕÍ¨ÐÅ£¬1´ò¿ªÍ¨ÐÅ
  24          extern bit transmit_comm1_flag;        //Ã¿¸ôÒ»¶ÎÊ±¼ä½«ÆäÖÃ1£¬ÔòÔÚmainº¯ÊýÖÐ·¢ÉäÊý¾Ý£¬¾Í²»»áÓ°Ïìtimer0µÄ¼ÆÊ±£¬·
             -¢ÉäÍêºó½«ÆäÖÃ0.
  25          extern bit battery_check;              //ÖÃ1Ê±£¬Ö´ÐÐÒ»´ÎµçÁ¿×ª»»£¬Ö´ÐÐÍêºó£¬½«ÆäÖÃ0
  26          extern bit Host_battery_high_flag;     //ÖÃ1Ê±£¬Ö´ÐÐÒ»´ÎÓïÒôÌáÊ¾£¬±íÊ¾³äµçÒÑÂú
  27          
  28          /*------- Private variable declarations --------------------------*/
  29          tWord ADC_check_result = 0;      //×÷ÎªAD¼ì²âÖµ
  30          bit battery_HV_flag = 1;         //µç³ØµçÎ»µÄ±ê¼Ç£¬1±íÊ¾ÏÖÔÚµç³ØÊÇÂúµÄ£¬0±íÊ¾»¹Ã»Âú¡£
  31          
  32          void main(void)
  33          {
  34   1         noVoice();
  35   1         InitTimer(50, 100);
  36   1         myPwm();       //¿ª·¢Éä»ú
  37   1      
  38   1         Moto_EN = 1;      //³õÊ¼»¯£¬¹Ø±ÕÂí´ï
  39   1         transmit_wire = 1;
  40   1         Voice_EN = 0;        //¿ª»úÊ±£¬½«¹¦·Å¹Ø±Õ
  41   1         
  42   1         ADC_check_result = GetADCResult(6); //ÉÏµçÊ±£¬µç³ØµçÁ¿¼ì²âÒ»´Î
  43   1         
  44   1         comm_whole_control = 1;       //¿ªÆôÍ¨ÐÅ
  45   1         stolen_alarm_count = 0;       //Çå±¨¾¯¼ÆÊýÆ÷
  46   1         stolen_alarm_flag = 0;        //Çå±¨¾¯±êÖ¾
  47   1      
  48   1         Transmitter_EN = 0;     //¹Ø±Õ·¢Éä»ú
  49   1      
  50   1         while(1)
  51   1         {
  52   2            if(stolen_alarm_flag == 1)    //±àÂë3¿ªÊ¼ÏàÓ¦µÄ±¨¾¯
  53   2            {
  54   3               if(stolen_alarm_count < 2)
C51 COMPILER V9.51   MAIN                                                                  11/14/2013 10:54:22 PAGE 2   

  55   3               {
  56   4                  Alarm_stolen_speech();     //ÌáÊ¾±»µÁ
  57   4                  Moto_Vibration();          //Âí´ïÕñ¶¯
  58   4                  stolen_alarm_count++;
  59   4               }
  60   3            }
  61   2      
  62   2            if(raised_alarm_flag == 1)    //Ì§Æð¿ªÊ¼ÏàÓ¦µÄ±¨¾¯
  63   2            {
  64   3               Alarm_raised_speech();     //ÌáÊ¾±»Ì§Æð
  65   3               Moto_Vibration();          //Âí´ïÕñ¶¯
  66   3               raised_alarm_flag = 0;
  67   3            }
  68   2      
  69   2            if(fell_alarm_flag == 1)
  70   2            {
  71   3               Alarm_fell_speech();       //ÌáÊ¾µ¹ÏÂ
  72   3               Moto_Vibration();          //Âí´ïÕñ¶¯
  73   3               fell_alarm_flag=0;
  74   3            }
  75   2      
  76   2            if(battery_check == 1)           //Ã¿¸ö3s¼ì²âÒ»´ÎµçÁ¿£¬Èç¹ûµç³ØÂúµÄ¾Í¼ì²âÊÇ·ñµÍÁË£¬Èç¹ûÊÇ²»ÂúµÄ¾Í¼ì²âÊÇ·ñ³äÂú¡£
  77   2            {
  78   3               ADC_check_result = GetADCResult(6); //µç³ØµçÁ¿¼ì²â
  79   3               battery_check = 0;
  80   3               
  81   3               if((battery_HV_flag == 1)&&(ADC_check_result <= 0x35a))
  82   3               {
  83   4                  battery_HV_flag = 0;
  84   4                  Battery_low_alarm_speech();      //µçÁ¿²»×ãÓïÒôÌáÊ¾
  85   4               }
  86   3               else if((battery_HV_flag == 0)&&(ADC_check_result >= 0x377))
  87   3               {
  88   4                  battery_HV_flag = 1;
  89   4                  Battery_high_alarm_speech();
  90   4               }  
  91   3            }
  92   2      
  93   2            if(transmit_comm1_flag == 1)
  94   2            {
  95   3               Receiver_EN = 0;     //´ò¿ª½ÓÊÕ»ú
  96   3               ComMode_1_Data(); //·¢ËÍÄ£Ê½1ÐÅºÅ
  97   3               Receiver_EN = 1;     //´ò¿ª½ÓÊÕ»ú
  98   3               transmit_comm1_flag = 0;
  99   3            }
 100   2      
 101   2            if(Host_battery_high_flag == 1)
 102   2            {
 103   3               Host_battery_high_alarm_speech();      //ÌáÊ¾Ö÷»úµçÒÑ¾­³äÂú
 104   3               Host_battery_high_flag = 0;
 105   3            }
 106   2         }
 107   1      }
 108          
 109          /*---------------------------------------------------
 110             end of file
 111          ----------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    167    ----
   CONSTANT SIZE    =   ----    ----
C51 COMPILER V9.51   MAIN                                                                  11/14/2013 10:54:22 PAGE 3   

   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
