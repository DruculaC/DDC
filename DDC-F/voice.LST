C51 COMPILER V9.51   VOICE                                                                 11/01/2013 17:05:51 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE VOICE
OBJECT MODULE PLACED IN voice.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\C51.EXE voice.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND TABS(3)

line level    source

   1          /*---------------------------------------------------
   2             voice.c (v1.00)
   3             
   4             语音提示子程序
   5          ---------------------------------------------------*/
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "voice.h"
  11          #include "Delay.h"
  12             
  13          /*--------------------------------------------------
  14             SC_Speech()
  15             
  16             调用语音芯片，播报语音提示，几次脉冲表示播放第
  17             几段语音提示
  18          ---------------------------------------------------*/
  19          void SC_Speech(tByte cnt)
  20             {                   
  21   1         tByte i;
  22   1         SC_RST = 0;
  23   1         delay_ms(40);
  24   1         SC_RST = 1;
  25   1         delay_ms(40);
  26   1         for(i=0;i < cnt;i++)
  27   1            {
  28   2            SC_DATA = 1;   // 数据脉冲高
  29   2            delay_us(350);    // 延时 100US
  30   2            SC_DATA = 0;   // 数据脉冲低
  31   2            delay_us(350);    // 延时 100US
  32   2            }
  33   1         }
  34          
  35          /*-------------------------------------------------
  36             noVoice()
  37             
  38             在上电的时候调用，屏蔽语音的误报
  39          --------------------------------------------------*/
  40          void noVoice()
  41             {
  42   1         P14 = 0;
  43   1         SC_DATA = 0;
  44   1         SC_RST = 0;
  45   1         delay_us(1000);   //上电复位防止干扰发声
  46   1         SC_RST = 1;
  47   1         delay_us(1000);
  48   1         P14 = 1;
  49   1         }
  50          
  51          /*-------------------------------------------------------------
  52             Alarm_stolen_speech()
  53             被盗之后的报警语音，附机接收到主机的被盗信号，发出语音提示
  54          ---------------------------------------------------------------*/
  55          void Alarm_stolen_speech(void)
C51 COMPILER V9.51   VOICE                                                                 11/01/2013 17:05:51 PAGE 2   

  56             {
  57   1         Voice_EN = 1;
  58   1         SC_Speech(5);
  59   1         Delay(150);
  60   1         SC_Speech(6);
  61   1         Delay(80);
  62   1         SC_Speech(7);
  63   1         Delay(120);
  64   1         Voice_EN = 0;
  65   1         }
  66             
  67          /*--------------------------------------------------------------
  68             Alarm_raised_speech()
  69             主机被抬起时，给附机发信号，附机语音提示主机被抬起。
  70          ---------------------------------------------------------------*/
  71          void Alarm_raised_speech(void)
  72             {
  73   1         Voice_EN = 1;
  74   1         SC_Speech(4);
  75   1         Delay(180);
  76   1         Voice_EN = 0;
  77   1         }
  78             
  79          /*--------------------------------------------------------------
  80             Alarm_fell_speech()
  81             主机摔倒在地上后，附机语音提示主机倒地上了。
  82          ----------------------------------------------------------------*/
  83          void Alarm_fell_speech(void)
  84             {
  85   1         Voice_EN = 1;
  86   1         SC_Speech(8);
  87   1         Delay(180);
  88   1         Voice_EN = 0;
  89   1         }
  90             
  91          /*---------------------------------------------------------------
  92             Battery_low_alarm_speech()
  93             电量低于一定值的时候，附机语音提示电量不足
  94          ----------------------------------------------------------------*/
  95          void Battery_low_alarm_speech(void)
  96             {
  97   1            Voice_EN = 1;
  98   1            SC_Speech(9);
  99   1            Delay(120);
 100   1            Voice_EN = 0;
 101   1         }
 102          
 103          /*---------------------------------------------------------------
 104             Battery_high_alarm_speech()
 105             附机电池电量高于一定值，表示电池充满电，语音提示充满
 106          ----------------------------------------------------------------*/
 107          void Battery_high_alarm_speech(void)
 108             {
 109   1         Voice_EN = 1;
 110   1         SC_Speech(2);
 111   1         Delay(120);
 112   1         Voice_EN = 0;
 113   1         }
 114             
 115          /*---------------------------------------------------------------
 116             Host_battery_high_alarm_speech()
 117             当主机电充满后，发送信号给附机，附机收到后，语音提示主机充满电
C51 COMPILER V9.51   VOICE                                                                 11/01/2013 17:05:51 PAGE 3   

 118             了。
 119          ---------------------------------------------------------------*/
 120          void Host_battery_high_alarm_speech(void)
 121             {
 122   1            Voice_EN = 1;
 123   1            SC_Speech(2);  
 124   1            Delay(80);
 125   1            SC_Speech(3);  
 126   1            Delay(80);
 127   1            Voice_EN = 0;
 128   1         }
 129          
 130          /*---------------------------------------------------
 131             end of file
 132          ----------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    216    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
