C51 COMPILER V9.51   VOICE                                                                 11/20/2013 10:31:17 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE VOICE
OBJECT MODULE PLACED IN voice.OBJ
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C51\BIN\C51.EXE voice.c ROM(COMPACT) BROWSE DEBUG OBJECTEXTEND TABS(3)

line level    source

   1          /*---------------------------------------------------
   2             voice.c (v1.00)
   3             
   4             语音提示子程序
   5          ---------------------------------------------------*/
   6          
   7          #include "main.h"
   8          #include "port.h"
   9          
  10          #include "voice.h"
  11          #include "Delay.h"
  12             
  13          /*--------------------------------------------------
  14             SC_Speech()
  15             
  16             调用语音芯片，播报语音提示，几次脉冲表示播放第
  17             几段语音提示
  18          ---------------------------------------------------*/
  19          void SC_Speech(tByte cnt)
  20             {                   
  21   1         tByte i;
  22   1         SC_RST = 0;
  23   1         delay_ms(40);
  24   1         SC_RST = 1;
  25   1         delay_ms(40);
  26   1         for(i=0;i < cnt;i++)
  27   1            {
  28   2            SC_DATA = 1;   // 数据脉冲高
  29   2            delay_us(350);    // 延时 100US
  30   2            SC_DATA = 0;   // 数据脉冲低
  31   2            delay_us(350);    // 延时 100US
  32   2            }
  33   1         }
  34          
  35          /*-------------------------------------------------
  36             noVoice()
  37             
  38             在上电的时候调用，屏蔽语音的误报
  39          --------------------------------------------------*/
  40          void noVoice()
  41             {
  42   1         P14 = 0;
  43   1         SC_DATA = 0;
  44   1         SC_RST = 0;
  45   1         delay_us(1000);   //上电复位防止干扰发声
  46   1         SC_RST = 1;
  47   1         delay_us(1000);
  48   1         P14 = 1;
  49   1         }
  50          
  51          /*-------------------------------------------------------------
  52             Alarm_stolen_speech()
  53             被盗之后的报警语音，附机接收到主机的被盗信号，发出语音提示
  54          ---------------------------------------------------------------*/
  55          void Alarm_stolen_speech(void)
C51 COMPILER V9.51   VOICE                                                                 11/20/2013 10:31:17 PAGE 2   

  56             {
  57   1         Voice_EN = 1;
  58   1         SC_Speech(5);
  59   1         Delay(100);
  60   1         SC_Speech(12);
  61   1         Delay(50);
  62   1         Voice_EN = 0;
  63   1         }
  64             
  65          /*--------------------------------------------------------------
  66             Alarm_raised_speech()
  67             主机被抬起时，给附机发信号，附机语音提示主机被抬起。
  68          ---------------------------------------------------------------*/
  69          void Alarm_raised_speech(void)
  70             {
  71   1         Voice_EN = 1;
  72   1         SC_Speech(3);
  73   1         Delay(140);
  74   1         Voice_EN = 0;
  75   1         }
  76             
  77          /*--------------------------------------------------------------
  78             Alarm_fell_speech()
  79             主机摔倒在地上后，附机语音提示主机倒地上了。
  80          ----------------------------------------------------------------*/
  81          void Alarm_fell_speech(void)
  82             {
  83   1         Voice_EN = 1;
  84   1         SC_Speech(2);
  85   1         Delay(120);
  86   1         Voice_EN = 0;
  87   1         }
  88             
  89          /*---------------------------------------------------------------
  90             Battery_low_alarm_speech()
  91             电量低于一定值的时候，附机语音提示电量不足
  92          ----------------------------------------------------------------*/
  93          void Battery_low_alarm_speech(void)
  94             {
  95   1            Voice_EN = 1;
  96   1            SC_Speech(10);
  97   1            Delay(120);
  98   1            Voice_EN = 0;
  99   1         }
 100          
 101          /*---------------------------------------------------------------
 102             Battery_high_alarm_speech()
 103             附机电池电量高于一定值，表示电池充满电，语音提示充满
 104          ----------------------------------------------------------------*/
 105          void Battery_high_alarm_speech(void)
 106             {
 107   1         Voice_EN = 1;
 108   1         SC_Speech(7);
 109   1         Delay(120);
 110   1         Voice_EN = 0;
 111   1         }
 112             
 113          /*---------------------------------------------------------------
 114             Host_battery_high_alarm_speech()
 115             当主机电充满后，发送信号给附机，附机收到后，语音提示主机充满电
 116             了。
 117          ---------------------------------------------------------------*/
C51 COMPILER V9.51   VOICE                                                                 11/20/2013 10:31:17 PAGE 3   

 118          void Host_battery_high_alarm_speech(void)
 119             {
 120   1            Voice_EN = 1;
 121   1            SC_Speech(7);  
 122   1            Delay(80);
 123   1            Voice_EN = 0;
 124   1         }
 125          
 126          /*---------------------------------------------------
 127             end of file
 128          ----------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    192    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
